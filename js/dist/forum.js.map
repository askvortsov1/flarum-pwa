{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@askvortsov/flarum-pwa/./node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://@askvortsov/flarum-pwa/./node_modules/@babel/runtime/helpers/typeof.js","webpack://@askvortsov/flarum-pwa/./node_modules/@babel/runtime/regenerator/index.js","webpack://@askvortsov/flarum-pwa/webpack/bootstrap","webpack://@askvortsov/flarum-pwa/webpack/runtime/compat get default export","webpack://@askvortsov/flarum-pwa/webpack/runtime/define property getters","webpack://@askvortsov/flarum-pwa/webpack/runtime/hasOwnProperty shorthand","webpack://@askvortsov/flarum-pwa/webpack/runtime/make namespace object","webpack://@askvortsov/flarum-pwa/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://@askvortsov/flarum-pwa/external root \"flarum.core.compat['common/extend']\"","webpack://@askvortsov/flarum-pwa/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@askvortsov/flarum-pwa/./node_modules/idb/build/esm/wrap-idb-value.js","webpack://@askvortsov/flarum-pwa/./node_modules/idb/build/esm/index.js","webpack://@askvortsov/flarum-pwa/external root \"flarum.core.compat['common/components/Page']\"","webpack://@askvortsov/flarum-pwa/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@askvortsov/flarum-pwa/external root \"flarum.core.compat['forum/components/SessionDropdown']\"","webpack://@askvortsov/flarum-pwa/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@askvortsov/flarum-pwa/external root \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@askvortsov/flarum-pwa/external root \"flarum.core.compat['forum/utils/PostControls']\"","webpack://@askvortsov/flarum-pwa/external root \"flarum.core.compat['forum/utils/UserControls']\"","webpack://@askvortsov/flarum-pwa/external root \"flarum.core.compat['common/components/Button']\"","webpack://@askvortsov/flarum-pwa/./src/forum/addShareButtons.js","webpack://@askvortsov/flarum-pwa/external root \"flarum.core.compat['forum/components/NotificationGrid']\"","webpack://@askvortsov/flarum-pwa/external root \"flarum.core.compat['forum/components/SettingsPage']\"","webpack://@askvortsov/flarum-pwa/external root \"flarum.core.compat['common/components/Alert']\"","webpack://@askvortsov/flarum-pwa/external root \"flarum.core.compat['common/components/Link']\"","webpack://@askvortsov/flarum-pwa/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@askvortsov/flarum-pwa/./src/forum/addPushNotifications.js","webpack://@askvortsov/flarum-pwa/./src/forum/index.js"],"sourcesContent":["var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorRuntime() {\n  \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return exports;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var exports = {},\n    Op = Object.prototype,\n    hasOwn = Op.hasOwnProperty,\n    defineProperty = Object.defineProperty || function (obj, key, desc) {\n      obj[key] = desc.value;\n    },\n    $Symbol = \"function\" == typeof Symbol ? Symbol : {},\n    iteratorSymbol = $Symbol.iterator || \"@@iterator\",\n    asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\",\n    toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n  function define(obj, key, value) {\n    return Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), obj[key];\n  }\n  try {\n    define({}, \"\");\n  } catch (err) {\n    define = function define(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator,\n      generator = Object.create(protoGenerator.prototype),\n      context = new Context(tryLocsList || []);\n    return defineProperty(generator, \"_invoke\", {\n      value: makeInvokeMethod(innerFn, self, context)\n    }), generator;\n  }\n  function tryCatch(fn, obj, arg) {\n    try {\n      return {\n        type: \"normal\",\n        arg: fn.call(obj, arg)\n      };\n    } catch (err) {\n      return {\n        type: \"throw\",\n        arg: err\n      };\n    }\n  }\n  exports.wrap = wrap;\n  var ContinueSentinel = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n  var getProto = Object.getPrototypeOf,\n    NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function (method) {\n      define(prototype, method, function (arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (\"throw\" !== record.type) {\n        var result = record.arg,\n          value = result.value;\n        return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function (err) {\n          invoke(\"throw\", err, resolve, reject);\n        }) : PromiseImpl.resolve(value).then(function (unwrapped) {\n          result.value = unwrapped, resolve(result);\n        }, function (error) {\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n      reject(record.arg);\n    }\n    var previousPromise;\n    defineProperty(this, \"_invoke\", {\n      value: function value(method, arg) {\n        function callInvokeWithMethodAndArg() {\n          return new PromiseImpl(function (resolve, reject) {\n            invoke(method, arg, resolve, reject);\n          });\n        }\n        return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = \"suspendedStart\";\n    return function (method, arg) {\n      if (\"executing\" === state) throw new Error(\"Generator is already running\");\n      if (\"completed\" === state) {\n        if (\"throw\" === method) throw arg;\n        return doneResult();\n      }\n      for (context.method = method, context.arg = arg;;) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n        if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) {\n          if (\"suspendedStart\" === state) throw state = \"completed\", context.arg;\n          context.dispatchException(context.arg);\n        } else \"return\" === context.method && context.abrupt(\"return\", context.arg);\n        state = \"executing\";\n        var record = tryCatch(innerFn, self, context);\n        if (\"normal\" === record.type) {\n          if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue;\n          return {\n            value: record.arg,\n            done: context.done\n          };\n        }\n        \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(delegate, context) {\n    var methodName = context.method,\n      method = delegate.iterator[methodName];\n    if (undefined === method) return context.delegate = null, \"throw\" === methodName && delegate.iterator[\"return\"] && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method) || \"return\" !== methodName && (context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a '\" + methodName + \"' method\")), ContinueSentinel;\n    var record = tryCatch(method, delegate.iterator, context.arg);\n    if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel;\n    var info = record.arg;\n    return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel);\n  }\n  function pushTryEntry(locs) {\n    var entry = {\n      tryLoc: locs[0]\n    };\n    1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);\n  }\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\", delete record.arg, entry.completion = record;\n  }\n  function Context(tryLocsList) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) return iteratorMethod.call(iterable);\n      if (\"function\" == typeof iterable.next) return iterable;\n      if (!isNaN(iterable.length)) {\n        var i = -1,\n          next = function next() {\n            for (; ++i < iterable.length;) if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next;\n            return next.value = undefined, next.done = !0, next;\n          };\n        return next.next = next;\n      }\n    }\n    return {\n      next: doneResult\n    };\n  }\n  function doneResult() {\n    return {\n      value: undefined,\n      done: !0\n    };\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), defineProperty(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) {\n    var ctor = \"function\" == typeof genFun && genFun.constructor;\n    return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name));\n  }, exports.mark = function (genFun) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun;\n  }, exports.awrap = function (arg) {\n    return {\n      __await: arg\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    void 0 === PromiseImpl && (PromiseImpl = Promise);\n    var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);\n    return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) {\n      return result.done ? result.value : iter.next();\n    });\n  }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () {\n    return this;\n  }), define(Gp, \"toString\", function () {\n    return \"[object Generator]\";\n  }), exports.keys = function (val) {\n    var object = Object(val),\n      keys = [];\n    for (var key in object) keys.push(key);\n    return keys.reverse(), function next() {\n      for (; keys.length;) {\n        var key = keys.pop();\n        if (key in object) return next.value = key, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, exports.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(skipTempReset) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined);\n    },\n    stop: function stop() {\n      this.done = !0;\n      var rootRecord = this.tryEntries[0].completion;\n      if (\"throw\" === rootRecord.type) throw rootRecord.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(exception) {\n      if (this.done) throw exception;\n      var context = this;\n      function handle(loc, caught) {\n        return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught;\n      }\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i],\n          record = entry.completion;\n        if (\"root\" === entry.tryLoc) return handle(\"end\");\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\"),\n            hasFinally = hasOwn.call(entry, \"finallyLoc\");\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n          } else {\n            if (!hasFinally) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n      finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);\n      var record = finallyEntry ? finallyEntry.completion : {};\n      return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);\n    },\n    complete: function complete(record, afterLoc) {\n      if (\"throw\" === record.type) throw record.arg;\n      return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;\n    },\n    finish: function finish(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;\n      }\n    },\n    \"catch\": function _catch(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (\"throw\" === record.type) {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(iterable, resultName, nextLoc) {\n      return this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel;\n    }\n  }, exports;\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(obj);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst cursorRequestMap = new WeakMap();\nconst transactionDoneMap = new WeakMap();\nconst transactionStoreNamesMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    promise\n        .then((value) => {\n        // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval\n        // (see wrapFunction).\n        if (value instanceof IDBCursor) {\n            cursorRequestMap.set(value, request);\n        }\n        // Catching to avoid \"Uncaught Promise exceptions\"\n    })\n        .catch(() => { });\n    // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Polyfill for objectStoreNames because of Edge.\n            if (prop === 'objectStoreNames') {\n                return target.objectStoreNames || transactionStoreNamesMap.get(target);\n            }\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Edge doesn't support objectStoreNames (booo), so we polyfill it here.\n    if (func === IDBDatabase.prototype.transaction &&\n        !('objectStoreNames' in IDBTransaction.prototype)) {\n        return function (storeNames, ...args) {\n            const tx = func.call(unwrap(this), storeNames, ...args);\n            transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);\n            return wrap(tx);\n        };\n    }\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(cursorRequestMap.get(this));\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\nexport { reverseTransformCache as a, instanceOfAny as i, replaceTraps as r, unwrap as u, wrap as w };\n","import { w as wrap, r as replaceTraps } from './wrap-idb-value.js';\nexport { u as unwrap, w as wrap } from './wrap-idb-value.js';\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction));\n        });\n    }\n    if (blocked)\n        request.addEventListener('blocked', () => blocked());\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking)\n            db.addEventListener('versionchange', () => blocking());\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked)\n        request.addEventListener('blocked', () => blocked());\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        const returnVal = await target[targetFuncName](...args);\n        if (isWrite)\n            await tx.done;\n        return returnVal;\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nexport { deleteDB, openDB };\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SessionDropdown'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/DiscussionControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/PostControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/UserControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","import { extend } from 'flarum/common/extend';\nimport extractText from 'flarum/common/utils/extractText';\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\nimport PostControls from 'flarum/forum/utils/PostControls';\nimport UserControls from 'flarum/forum/utils/UserControls';\nimport Button from 'flarum/common/components/Button';\n\nasync function shareContent(data) {\n  try {\n    const title = extractText(data.title);\n    await navigator.share({ title, url: data.url });\n    resultPara.textContent = 'MDN shared successfully';\n  } catch (err) {\n    console.log('Error: ' + err);\n  }\n}\n\nexport default () => {\n  extend(DiscussionControls, 'userControls', function (items, discussion) {\n    if (!navigator.share) return;\n\n    items.add(\n      'share',\n      Button.component(\n        {\n          icon: 'fas fa-share-square',\n          onclick: () =>\n            shareContent({\n              title: discussion.title(),\n              url: window.location.protocol + '//' + window.location.hostname + app.route.discussion(discussion),\n            }),\n        },\n        app.translator.trans('askvortsov-pwa.forum.discussion_controls.share_button')\n      ),\n      -1\n    );\n  });\n\n  extend(PostControls, 'userControls', function (items, post) {\n    if (!navigator.share) return;\n\n    items.add(\n      'share',\n      Button.component(\n        {\n          icon: 'fas fa-share-square',\n          onclick: () =>\n            shareContent({\n              title: app.translator.trans('askvortsov-pwa.forum.post_controls.share_api.title', {\n                username: post.user().displayName(),\n                title: post.discussion().title(),\n              }),\n              url: window.location.protocol + '//' + window.location.hostname + app.route.post(post),\n            }),\n        },\n        app.translator.trans('askvortsov-pwa.forum.post_controls.share_button')\n      ),\n      100\n    );\n  });\n\n  extend(UserControls, 'userControls', function (items, user) {\n    if (!navigator.share) return;\n\n    items.add(\n      'share',\n      Button.component(\n        {\n          icon: 'fas fa-share-square',\n          onclick: () =>\n            shareContent({\n              title: user.displayName(),\n              url: window.location.protocol + '//' + window.location.hostname + app.route.user(user),\n            }),\n        },\n        app.translator.trans('askvortsov-pwa.forum.user_controls.share_button')\n      ),\n      100\n    );\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/NotificationGrid'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SettingsPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Alert'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","import { extend } from 'flarum/common/extend';\nimport NotificationGrid from 'flarum/forum/components/NotificationGrid';\nimport SettingsPage from 'flarum/forum/components/SettingsPage';\nimport Alert from 'flarum/common/components/Alert';\nimport Button from 'flarum/common/components/Button';\nimport Link from 'flarum/common/components/Link';\nimport Page from 'flarum/common/components/Page';\nimport icon from 'flarum/common/helpers/icon';\n\nconst subscribeUser = (save) => {\n  return app.sw.pushManager\n    .subscribe({\n      userVisibleOnly: true,\n      applicationServerKey: app.forum.attribute('vapidPublicKey'),\n    })\n    .then((subscription) => {\n      if (!save) return;\n\n      app.request({\n        method: 'POST',\n        url: app.forum.attribute('apiUrl') + '/pwa/push',\n        body: { subscription },\n      });\n    });\n};\n\nconst pushEnabled = () => {\n  if (!app.session.user) return false;\n\n  const obj = app.session.user.preferences();\n  let key;\n\n  for (key in obj) {\n    if ((typeof key === 'string' || key instanceof String) && key.startsWith('notify_') && key.endsWith('_push') && obj[key]) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\nexport const refreshSubscription = async (sw) => {\n  if (!app.cache.pwaRefreshed && 'Notification' in window && window.Notification.permission === 'granted' && pushEnabled())\n    try {\n      await subscribeUser(true);\n    } catch (e) {\n      if (!sw.pushManager) {\n        return;\n      }\n      sw.pushManager.getSubscription().then((s) => s.unsubscribe().then(subscribeUser.bind(this, true)));\n    }\n  app.cache.pwaRefreshed = true;\n};\n\nconst pushConfigured = () => {\n  return app.forum.attribute('vapidPublicKey');\n};\n\nexport default () => {\n  extend(Page.prototype, 'oncreate', () => {\n    if (!pushConfigured()) return;\n\n    const dismissAlert = () => {\n      localStorage.setItem('askvortov-pwa.notif-alert.dismissed', JSON.stringify({ timestamp: new Date().getTime() }));\n    };\n\n    app.alerts.dismiss(app.cache.pwaNotifsAlert);\n\n    if (\n      !localStorage.getItem('askvortov-pwa.notif-alert.dismissed') &&\n      'Notification' in window &&\n      window.Notification.permission === 'default' &&\n      pushEnabled()\n    ) {\n      app.cache.pwaNotifsAlert = app.alerts.show(\n        {\n          controls: [\n            <Link class=\"Button Button--link\" href={app.route('settings')} onclick={() => dismissAlert()}>\n              {app.translator.trans('askvortsov-pwa.forum.alerts.optin_button')}\n            </Link>,\n          ],\n          ondismiss: dismissAlert,\n        },\n        app.translator.trans('askvortsov-pwa.forum.alerts.optin')\n      );\n    }\n  });\n\n  extend(NotificationGrid.prototype, 'notificationMethods', function (items) {\n    if (!pushConfigured()) return;\n\n    items.add('push', {\n      name: 'push',\n      icon: 'fas fa-mobile',\n      label: app.translator.trans('askvortsov-pwa.forum.settings.push_header'),\n    });\n  });\n\n  extend(SettingsPage.prototype, 'notificationsItems', function (items) {\n    if (!pushConfigured()) return;\n\n    if (!('Notification' in window)) {\n      items.add(\n        'push-no-browser-support',\n        Alert.component(\n          {\n            dismissible: false,\n            controls: [\n              <a class=\"Button Button--link\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/Push_API\">\n                {app.translator.trans('askvortsov-pwa.forum.settings.pwa_notifications.no_browser_support_button')}\n              </a>,\n            ],\n          },\n          [icon('fas fa-exclamation-triangle'), app.translator.trans('askvortsov-pwa.forum.settings.pwa_notifications.no_browser_support')]\n        ),\n        10\n      );\n      return;\n    }\n\n    if (window.Notification.permission === 'default') {\n      if (!pushConfigured()) return;\n\n      items.add(\n        'push-optin-default',\n        Alert.component(\n          {\n            itemClassName: 'pwa-setting-alert',\n            dismissible: false,\n            controls: [\n              Button.component(\n                {\n                  className: 'Button Button--link',\n                  onclick: () => {\n                    window.Notification.requestPermission((res) => {\n                      m.redraw();\n\n                      if (res === 'granted') {\n                        subscribeUser(true);\n                      }\n                    });\n                  },\n                },\n                app.translator.trans('askvortsov-pwa.forum.settings.pwa_notifications.access_default_button')\n              ),\n            ],\n          },\n          [icon('fas fa-exclamation-circle'), app.translator.trans('askvortsov-pwa.forum.settings.pwa_notifications.access_default')]\n        ),\n        10\n      );\n    } else if (window.Notification.permission === 'denied') {\n      items.add(\n        'push-optin-denied',\n        Alert.component(\n          {\n            itemClassName: 'pwa-setting-alert',\n            dismissible: false,\n            type: 'error',\n            controls: [\n              <a\n                class=\"Button Button--link\"\n                href=\"https://support.humblebundle.com/hc/en-us/articles/360008513933-Enabling-and-Disabling-Browser-Notifications-in-Various-Browsers\"\n              >\n                {app.translator.trans('askvortsov-pwa.forum.settings.pwa_notifications.access_denied_button')}\n              </a>,\n            ],\n          },\n          [icon('fas fa-exclamation-triangle'), app.translator.trans('askvortsov-pwa.forum.settings.pwa_notifications.access_denied')]\n        ),\n        10\n      );\n    }\n  });\n};\n","import { extend } from 'flarum/common/extend';\nimport { openDB } from 'idb';\n\nimport Page from 'flarum/common/components/Page';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport SessionDropdown from 'flarum/forum/components/SessionDropdown';\nimport addShareButtons from './addShareButtons';\nimport addPushNotifications, { refreshSubscription } from './addPushNotifications';\n\napp.initializers.add('askvortsov/flarum-pwa', () => {\n  const isInStandaloneMode = () =>\n    window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone || document.referrer.includes('android-app://');\n\n  extend(Page.prototype, 'oninit', () => {\n    const basePath = app.forum.attribute('basePath').trimRight('/');\n\n    const registerSW = async () => {\n      const dbPromise = openDB('keyval-store', 1, {\n        upgrade(db) {\n          db.createObjectStore('keyval');\n        },\n      });\n      (await dbPromise).put('keyval', app.forum.data.attributes, 'flarum.forumPayload');\n\n      if ('serviceWorker' in navigator) {\n        navigator.serviceWorker\n          .register(basePath + '/sw', {\n            scope: basePath + '/',\n          })\n          .then((sw) => {\n            navigator.serviceWorker.ready.then(() => {\n              app.sw = sw;\n              refreshSubscription(sw);\n            });\n          });\n      }\n    };\n\n    registerSW();\n  });\n\n  extend(SessionDropdown.prototype, 'items', (items) => {\n    if (isInStandaloneMode() && items.has('administration')) {\n      items.replace(\n        'administration',\n        LinkButton.component(\n          {\n            icon: 'fas fa-wrench',\n            href: app.forum.attribute('adminUrl'),\n            target: '_self',\n            external: true,\n          },\n          app.translator.trans('core.forum.header.admin_button')\n        )\n      );\n    }\n  });\n\n  addShareButtons();\n  addPushNotifications();\n});\n"],"names":["_typeof","require","_regeneratorRuntime","module","exports","__esModule","Op","Object","prototype","hasOwn","hasOwnProperty","defineProperty","obj","key","desc","value","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","fn","arg","type","call","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","method","_invoke","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","state","Error","undefined","done","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","methodName","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","length","i","doneResult","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","val","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","d","a","definition","o","get","prop","r","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","arguments","apply","flarum","core","compat","_extends","assign","bind","target","source","idbProxyableTypes","cursorAdvanceMethods","instanceOfAny","constructors","some","c","cursorRequestMap","WeakMap","transactionDoneMap","transactionStoreNamesMap","transformCache","reverseTransformCache","idbProxyTraps","receiver","IDBTransaction","objectStoreNames","objectStore","set","has","transformCachableValue","func","IDBDatabase","transaction","IDBCursor","advance","continuePrimaryKey","includes","_len2","Array","_key2","unwrap","_len3","_key3","storeNames","_len","_key","tx","concat","sort","unlisten","removeEventListener","DOMException","addEventListener","cacheDonePromiseForTransaction","IDBObjectStore","IDBIndex","Proxy","IDBRequest","request","promise","success","newValue","openDB","version","_temp","_ref","blocked","upgrade","blocking","terminated","indexedDB","open","openPromise","event","oldVersion","newVersion","db","oldTraps","readMethods","writeMethods","cachedMethods","Map","getMethod","targetFuncName","replace","useIndex","isWrite","_ref3","_callee","storeName","_target","returnVal","_args","_context","store","index","shift","_x","shareContent","_shareContent","data","title","extractText","navigator","share","url","resultPara","textContent","t0","console","log","subscribeUser","save","app","sw","pushManager","subscribe","userVisibleOnly","applicationServerKey","forum","attribute","subscription","body","pushEnabled","session","user","preferences","String","startsWith","endsWith","refreshSubscription","cache","pwaRefreshed","window","Notification","permission","getSubscription","s","unsubscribe","pushConfigured","initializers","add","extend","Page","basePath","trimRight","registerSW","dbPromise","createObjectStore","put","attributes","serviceWorker","register","scope","ready","SessionDropdown","items","matchMedia","matches","standalone","document","referrer","LinkButton","icon","href","external","translator","trans","DiscussionControls","discussion","Button","onclick","location","protocol","hostname","route","PostControls","post","username","UserControls","dismissAlert","localStorage","setItem","JSON","stringify","timestamp","Date","getTime","alerts","dismiss","pwaNotifsAlert","getItem","show","controls","m","Link","class","ondismiss","NotificationGrid","label","SettingsPage","Alert","itemClassName","dismissible","className","requestPermission","res","redraw"],"sourceRoot":""}