module.exports=function(t){var a={};function e(s){if(a[s])return a[s].exports;var n=a[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=t,e.c=a,e.d=function(t,a,s){e.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,a){if(1&a&&(t=e(t)),8&a)return t;if(4&a&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var n in t)e.d(s,n,function(a){return t[a]}.bind(null,n));return s},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},e.p="",e(e.s=20)}([function(t,a){t.exports=flarum.core.compat.extend},function(t,a){t.exports=flarum.core.compat["components/Button"]},function(t,a){t.exports=flarum.core.compat["components/Alert"]},,function(t,a){t.exports=flarum.core.compat["components/Page"]},,,,,,,,,function(t,a){t.exports=flarum.core.compat["components/AdminNav"]},function(t,a){t.exports=flarum.core.compat["components/AdminLinkButton"]},function(t,a){t.exports=flarum.core.compat["components/LoadingIndicator"]},function(t,a){t.exports=flarum.core.compat["utils/saveSettings"]},function(t,a){t.exports=flarum.core.compat["components/UploadImageButton"]},,function(t,a){t.exports=flarum.core.compat["components/Switch"]},function(t,a,e){"use strict";e.r(a);var s=e(0),n=e(13),o=e.n(n),r=e(14),i=e.n(r);function p(t,a){t.prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a}var l=e(4),u=e.n(l),c=e(1),d=e.n(c),v=e(2),f=e.n(v),h=e(15),g=e.n(h),w=(e(19),e(16)),b=e.n(w),_=e(17);var x=function(t){p(e,t);var a;a=e;function e(){return t.apply(this,arguments)||this}var s=e.prototype;return s.view=function(){app.data.settings;return this.props.loading=this.loading,this.props.className=(this.props.className||"")+" Button",app.data.settings["askvortsov-pwa.icon_"+this.props.name+"_path"]?(this.props.onclick=this.remove.bind(this),this.props.children=app.translator.trans("core.admin.upload_image.remove_button"),m("div",null,m("p",null,m("img",{src:app.forum.attribute("basePath").trimRight("/")+"/assets/"+app.data.settings["askvortsov-pwa.icon_"+this.props.name+"_path"],alt:""})),m("p",null,d.a.prototype.view.call(this)))):(this.props.onclick=this.upload.bind(this),this.props.children=app.translator.trans("core.admin.upload_image.upload_button"),t.prototype.view.call(this))},s.resourceUrl=function(){return app.forum.attribute("apiUrl")+"/pwa/logo/"+this.props.name},e}(e.n(_).a);var k=function(t){p(e,t);var a;a=e;function e(){return t.apply(this,arguments)||this}var s=e.prototype;return s.init=function(){t.prototype.init.call(this),this.saving=!1,this.refresh()},s.refresh=function(){var t=this;this.loading=!0;var a=app.data.settings;this.status_messages=[],this.manifest={},this.sizes=[],this.values={},this.fields=["askvortsov-pwa.longName","askvortsov-pwa.backgroundColor"],this.fields.forEach((function(e){return t.values[e]=m.prop(void 0!==a[e]?a[e]:"")})),app.request({method:"GET",url:app.forum.attribute("apiUrl")+"/pwa/settings"}).then((function(a){t.manifest=a.data.attributes.manifest,t.sizes=a.data.attributes.sizes,t.status_messages=a.data.attributes.status_messages,t.loading=!1,m.redraw()}))},s.checkExistence=function(t){var a=new XMLHttpRequest;return a.open("HEAD",t,!1),a.send(),404!=a.status},s.view=function(){return this.loading||this.saving?m("div",{className:"PWAPage"},m("div",{className:"container"},m(g.a,null))):m("div",{className:"PWAPage"},m("div",{className:"container"},m("form",{onsubmit:this.onsubmit.bind(this)},m("h2",null,app.translator.trans("askvortsov-pwa.admin.pwa.heading")),m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.text")),m("div",{class:"statusCheck"},m("legend",null,app.translator.trans("askvortsov-pwa.admin.pwa.status_check_heading")),this.status_messages.map((function(t){return f.a.component({type:t.type,children:[t.message],dismissible:!1})}))),m("fieldset",{class:"parent"},m("fieldset",null,m("legend",null,app.translator.trans("askvortsov-pwa.admin.pwa.about.heading")),m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.about.short_name_text")),m("input",{className:"FormControl",value:this.manifest.short_name,disabled:!0})),m("fieldset",null,m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.about.name_text")),m("input",{className:"FormControl",value:this.values["askvortsov-pwa.longName"](),oninput:m.withAttr("value",this.values["askvortsov-pwa.longName"]),required:!0})),m("fieldset",null,m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.about.description_text")),m("textarea",{className:"FormControl",value:this.manifest.description,disabled:!0},this.manifest.description))),m("fieldset",{class:"parent"},m("fieldset",null,m("legend",null,app.translator.trans("askvortsov-pwa.admin.pwa.colors.heading")),m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.colors.theme_color_text")),m("input",{className:"FormControl",type:"text",placeholder:"#aaaaaa",value:this.manifest.theme_color,disabled:!0})),m("fieldset",null,m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.colors.background_color_text")),m("input",{className:"FormControl",type:"text",placeholder:"#aaaaaa",value:this.values["askvortsov-pwa.backgroundColor"](),oninput:m.withAttr("value",this.values["askvortsov-pwa.backgroundColor"]),required:!0}))),d.a.component({type:"submit",className:"Button Button--primary",children:app.translator.trans("askvortsov-pwa.admin.pwa.submit_button")}),m("fieldset",null,m("legend",null,app.translator.trans("askvortsov-pwa.admin.pwa.logo_heading")),m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.logo_text")),this.sizes.map((function(t){return m("fieldset",{class:"logoFieldset"},m(x,{name:t}),m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.logo_size_text",{size:t})))}))))))},s.onsubmit=function(t){t.preventDefault();/^#[0-9a-f]{3}([0-9a-f]{3})?$/i.test(this.values["askvortsov-pwa.backgroundColor"]())?this.saveSettings():alert(app.translator.trans("core.admin.appearance.enter_hex_message"))},s.saveSettings=function(){var t=this;if(!this.saving){this.saving=!0,app.alerts.dismiss(this.successAlert);var a={};this.fields.forEach((function(e){return a[e]=t.values[e]()})),b()(a).then((function(){app.alerts.show(t.successAlert=new f.a({type:"success",children:app.translator.trans("core.admin.basics.saved_message")}))})).catch((function(){})).then((function(){t.saving=!1,t.refresh()}))}},e}(u.a);app.initializers.add("askvortsov/flarum-pwa",(function(){app.routes.pwa={path:"/pwa",component:k.component()},app.extensionSettings["askvortsov-pwa"]=function(){return m.route(app.route("pwa"))},Object(s.extend)(o.a.prototype,"items",(function(t){t.add("pwa",i.a.component({href:app.route("pwa"),icon:"fas fa-mobile-alt",children:app.translator.trans("askvortsov-pwa.admin.nav.pwa_button"),description:app.translator.trans("askvortsov-pwa.admin.nav.pwa_text")}))}))}))}]);
//# sourceMappingURL=admin.js.map